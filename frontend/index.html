<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ASR Thesis</title>
  <link rel="icon" type="image/png" href="favicon.png">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="app">
    <main class="main">
      <header class="toolbar">
        <div class="toolbar-left">
          <h1 class="logo-text">ASR Thesis</h1>
          
          <div class="dropdown">
            <button class="dropdown-btn" id="audioSourceBtn">
              <span id="audioSourceText">Microphone</span>
              <span class="dropdown-arrow"></span>
            </button>
            <div class="dropdown-menu wide" id="audioDropdown">
              <div class="dropdown-section">
                <div class="dropdown-label">Select Microphone</div>
                <div id="micList">
                  <div class="dropdown-item" data-source="microphone">Default Microphone</div>
                </div>
              </div>
              <div class="dropdown-divider"></div>
              <div class="dropdown-item" data-source="computer">Computer Audio</div>
            </div>
          </div>
          
          <div class="audio-meter-horizontal" id="audioMeter">
            <div class="meter-bar-h"></div>
            <div class="meter-bar-h"></div>
            <div class="meter-bar-h"></div>
            <div class="meter-bar-h"></div>
            <div class="meter-bar-h"></div>
            <div class="meter-bar-h"></div>
            <div class="meter-bar-h"></div>
            <div class="meter-bar-h"></div>
            <div class="meter-bar-h"></div>
            <div class="meter-bar-h"></div>
          </div>

          <button class="record-btn" id="recordBtn" title="Record">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>
              <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>
            </svg>
          </button>
        </div>

        <div class="toolbar-center">
          <div class="timer" id="timer">00:00</div>
        </div>

        <div class="toolbar-right">
          <button class="btn-icon" id="sidebarToggle" title="History">
            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2"/>
              <path d="M9 3v18"/>
            </svg>
          </button>
        </div>
      </header>

      <div class="content">
        <!-- Single Transcript Panel -->
        <div class="transcript-panel">
          <div class="panel-header">
            <!-- Language Dropdown in Panel Header -->
            <div class="dropdown">
              <button class="dropdown-btn" id="langBtn">
                <span id="langText">Vi ‚Üí En</span>
                <span class="dropdown-arrow"></span>
              </button>
              <div class="dropdown-menu" id="langDropdown">
                <div class="dropdown-item" data-src="vi" data-tgt="en">Vietnamese ‚Üí English</div>
                <div class="dropdown-item" data-src="en" data-tgt="vi">English ‚Üí Vietnamese</div>
                <div class="dropdown-divider"></div>
                <div class="dropdown-item" data-src="vi" data-tgt="">Vietnamese only</div>
                <div class="dropdown-item" data-src="en" data-tgt="">English only</div>
                <div class="dropdown-divider"></div>
                <div class="dropdown-item" data-src="auto" data-tgt="en">Auto-detect</div>
              </div>
            </div>
            <div class="panel-actions">
              <button class="btn-icon" id="fontDecrease" title="Smaller">A-</button>
              <button class="btn-icon" id="fontIncrease" title="Larger">A+</button>
              <button class="btn-icon" id="clearBtn" title="Clear">
                <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="3 6 5 6 21 6"/>
                  <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                </svg>
              </button>
              <button class="btn-icon" id="contextBtn" title="Context">
                <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="3"/>
                  <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
                </svg>
              </button>
              <button class="btn-icon" id="copyBtn" title="Copy">
                <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="9" y="9" width="13" height="13" rx="2"/>
                  <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
                </svg>
              </button>
            </div>
          </div>
          <div class="panel-content" id="panelContent">
            <div class="empty-state">
              <p>Click the record button to start</p>
              <p>Transcription will appear here</p>
            </div>
          </div>
        </div>

        <aside class="sidebar" id="sidebar">
          <div class="sidebar-header">
            <h3>History</h3>
            <a href="recordings.html" class="btn btn-secondary btn-sm">View All</a>
          </div>
          <div class="sidebar-content" id="recordingsList">
            <div class="empty-state">
              <p>No recordings yet</p>
            </div>
          </div>
        </aside>
      </div>
    </main>
  </div>

  <div class="modal-overlay" id="contextModal">
    <div class="modal">
      <div class="modal-header">
        <h3>Context Settings</h3>
        <button class="modal-close" id="closeModal" title="Close">√ó</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label>Lecture Topic</label>
          <input type="text" id="lectureTopic" placeholder="e.g., Machine Learning c∆° b·∫£n, Gi·∫£i t√≠ch 2...">
          <small class="form-hint">AI will expand this into keywords to improve accuracy</small>
        </div>
        <div class="form-group">
          <label>Keywords</label>
          <div class="input-with-btn">
            <input type="text" id="keywords" placeholder="AI, machine learning, neural network...">
            <button class="btn btn-sm btn-accent" id="aiGenerateBtn" title="AI Generate from topic">‚ö° Generate</button>
          </div>
        </div>
        <div class="form-group">
          <label>Context</label>
          <textarea id="context" placeholder="Lecture about artificial intelligence..."></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="clearContextBtn">Clear</button>
        <button class="btn btn-primary" id="saveContextBtn">Save</button>
      </div>
    </div>
  </div>

  <div class="modal-overlay" id="clearModal">
    <div class="modal">
      <div class="modal-header">
        <h3>Clear Transcript</h3>
        <button class="modal-close" title="Close">x</button>
      </div>
      <div class="modal-body">
        <p>Clear the current transcript display?</p>
        <p class="text-muted">Saved recordings will not be affected.</p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary">Cancel</button>
        <button class="btn btn-primary">Clear</button>
      </div>
    </div>
  </div>

  <div class="modal-overlay" id="deleteRecordingModal">
    <div class="modal">
      <div class="modal-header">
        <h3>Delete Recording</h3>
        <button class="modal-close" id="deleteModalClose" title="Close">x</button>
      </div>
      <div class="modal-body">
        <p>Delete this recording permanently?</p>
        <p class="text-muted">This action cannot be undone.</p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="deleteModalCancel">Cancel</button>
        <button class="btn btn-danger" id="deleteModalConfirm">Delete</button>
      </div>
    </div>
  </div>

  <div class="notification" id="notification"></div>

  <!-- Summary modal (Groq auto-summary) -->
  <div class="modal-overlay" id="summaryModal">
    <div class="modal modal-lg">
      <div class="modal-header">
        <h3>üìù Lecture Summary</h3>
        <button class="modal-close" id="closeSummaryModal" title="Close">√ó</button>
      </div>
      <div class="modal-body">
        <div id="summaryContent" class="summary-content"></div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="copySummaryBtn">Copy</button>
        <button class="btn btn-primary" id="closeSummaryBtn">Close</button>
      </div>
    </div>
  </div>
  
  <script type="module" src="js/utils.js"></script>
  <script type="module" src="js/main.js"></script>
</body>
</html>
